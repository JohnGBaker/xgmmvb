kdtree.py:
	Realizes a kmeans with kdtrees

xmeans.py: Realizes xmeans with kdtrees

gmm.py: Realizes gmm clustering

###
making movie from multipage pdf:
python testgmm.py
convert test.pdf test-%03d.jpg
ffmpeg -pattern_type glob -i 'test-*.jpg' -r 20 -pix_fmt yuv420p test.mp4
rm test-???.jpg


############
gmmvb testing:  code at hash: 3abc8df
############

xgmmvb
python -u testgmmvb.py -k8 -n1000 -s556987 -x -t 10 | & less
-->
Models:
  F= 1542.9207140651865   W= [103.00014495851325, 45.999999837306454, 89.75241013022324, 161.90651838105174, 408.3409266929053]
  F= 1542.9207140540916   W= [161.9065185249419, 103.00014886369344, 45.99999983730809, 89.75207064297177, 408.3412621310848]
  F= 1542.920714063764   W= [45.99999983730677, 103.00014594760815, 89.75236166348463, 161.90651842022692, 408.3409741313735]
  F= 1542.9207140536903   W= [103.00014903135835, 161.90651853109011, 45.99999983730817, 408.34127697812164, 89.75205562212182]
  F= 1542.920714015683   W= [103.00015984518757, 161.90651893421676, 408.34214087955576, 45.99999983731251, 89.75118050372738]
  F= 1542.92071406535   W= [45.999999837306454, 103.00014500677074, 161.90651838336095, 408.34092266570923, 89.75241410685268]
  F= 1542.9207140650963   W= [45.99999983730643, 103.00014492207318, 408.34092344563874, 161.90651837971666, 89.75241341526498]
  F= 1542.9207140540589   W= [103.0001493335964, 89.75206265001465, 161.9065185446924, 45.99999983730818, 408.34126963438837]
  F= 1542.9207140654212   W= [45.999999837306454, 408.3409260452075, 161.90651838475867, 103.00014504489363, 89.75241068783377]
  F= 1542.9207140384085   W= [103.0001539008605, 161.90651871323826, 45.99999983731009, 89.75166914222407, 408.34165840636706]
mean time = 22.242760872840883
best model F= 1542.9207140654212
weights= [45.999999837306454, 408.3409260452075, 161.90651838475867, 103.00014504489363, 89.75241068783377]

###
And with c=5 fixed:
###

python -u testgmmvb.py -k8 -n1000 -s556987 -c5 -t 10 | & less
-->
Models:
  F= 1490.1439618126376   W= [103.59489108847974, 161.92814923824983, 45.99999998226009, 4.06545295893577e-44, 497.4769596910104]
  F= 1175.3575132595683   W= [210.14125154477512, 4.8515553971123815, 90.1565368135619, 103.01545258994085, 400.83520365460976]
  F= 1173.1961342676218   W= [394.40858619481327, 210.11327347450927, 88.27255580727861, 13.204902193105728, 103.0006823302931]
  F= 1172.7073017429218   W= [84.91069953306656, 20.23682176284223, 403.9240790921687, 89.71261204790423, 210.21578756401823]
  F= 1175.3575121417596   W= [4.8515621790891945, 103.01543102223808, 400.83323594903675, 90.15851345585249, 210.14125739378352]
  F= 1487.826219111527   W= [72.90437789558628, 45.99999999996385, 424.6970303659373, 161.99338415722846, 103.40520758128413]
  F= 1119.507667548807   W= [93.27844787364154, 403.0110727617358, 11.263645385219041, 211.14740672051468, 90.29942725888893]
  F= 1120.009612936655   W= [86.51067259452448, 19.771762350103753, 210.2258139730396, 485.43394408018037, 7.057807002151811]
  F= 1176.2037710278828   W= [1.838934445751502, 88.73582094270643, 405.2578190609621, 103.06413792262722, 210.10328762795274]
  F= 1542.9207029320255   W= [408.3053133945571, 102.99974632193752, 45.99999983713526, 89.78843671279638, 161.90650373357371]
mean time = 5.470864844322205
best model F= 1542.9207029320255
weights= [408.3053133945571, 102.99974632193752, 45.99999983713526, 89.78843671279638, 161.90650373357371]

Comments: with xgmmvb the same result is found each time to 11 digits in F while with c=5 fixed, although the speed is about 4x faster per run,  this optimal result is found only 1/10 times (and of course there has been no comparison versus other numbers of centers).

######
Varying --tol
hash=4cf1024
######
xgmmvb:
tol	F		dF	<time>
0.01	1542.920714065	5e-8	22.2s
0.1	1542.92071408	1e-6	18.7
1.0	1542.92071408   4e-6	11.7	#This seems to be the marginal/optimal case
3.0	1542.920714   	40	5.4     #some cases found 4 components
10.	1542.92069	40	3.4	#some cases found 4 components
100.	1499.279797125  5e-7	1.9	#all cases found 4 components

gmmvb: c=5  #All find only 1/10 good fits (same initializations)
tol	F		dF
0.01	1542.92070    	300	5.5s
0.1	1542.9206	300	4.8
1.0	1542.919	300	2.4
10.	1542.912	300	1.3

xgmmvb: UpdateTol=0.05
0.1	1542.92071405   4e-7	14.3	
1.0	1542.92071407   1e-5	6.8	

##############
xgmmvb: UpdateTol=0.05 k=18 n~3000 1 trial tol 1.0
Models:
  F= 3682.7528729508076   W= [330.6627229262142, 254.96783782724003, 159.29759615627881, 158.335822049779, 214.06192777390604, 90.99457170368282, 508.00912196912157, 438.75092456068285, 112.31614961741695, 353.6033254156777]
  F= 3682.753345889062   W= [112.29740032408351, 330.6516210585445, 254.98061302098824, 158.33571602009005, 214.66207428963608, 438.58752103232456, 507.67621098280904, 90.99462019557444, 353.604057724563, 159.2101653513866]
  F= 3682.75284467042   W= [158.33577186101365, 330.6634630420002, 254.96997817887333, 438.73805956067946, 508.01690313743916, 214.0095777999046, 159.29850653349556, 90.99456775565619, 112.31721145289762, 353.6559606780402]
mean time = 216.39513810475668
Skipped 22 / 87

xgmmvb: UpdateTol=-1 k=18 n~3000 1 trials 3 tol 1.0
Models:
  F= 3682.752694986678   W= [330.6598434328918, 213.56573482678277, 159.27599092901957, 158.3356267214053, 90.99454952376067, 507.95015472397733, 438.6031824569565, 254.9941849798995, 354.30742231267857, 112.31331009262792]
  F= 2190.2540170327384   W= [2290.3917128108633, 330.6082871891369]
  F= 3661.7301425037376   W= [330.3705631416697, 158.37669792472653, 90.99495099393367, 259.8786417608249, 674.7416375079033, 100.21963440345002, 453.0704249667255, 244.50282535301812, 308.8446239477482]
mean time = 157.53077030181885
Skipped none

python -u testgmmvb.py -k28 -n10000 -s556987 -x -t3 -d6 --tol=1. > & d6k28n3kt1.out &
-->
Models:
  F= 79115.22207899403   W= [255.71326869486953, 158.99998717915955, 448.999770866873, 637.999999997962, 159.99057393061986, 276.9997719898816, 618.9999999999995, 375.99999999998727, 182.99982725852135, 596.9999935527414, 347.0, 522.0265518059957, 257.9999999999984, 674.9999963978411, 456.9999962002852, 424.0, 245.99999999999537, 533.9604918873939, 389.0000000000046, 17.98790689417974, 119.0, 100.99997874409974, 292.32195793074254, 16.0, 156.99988376598134, 3.999999801648798, 21.00004310121875]
  F= 79115.22207899479   W= [276.99977198988137, 618.9999999999995, 522.0265503891654, 389.0000000000046, 424.0, 347.0, 375.99999999998727, 596.9999935527405, 119.0, 182.9998272585156, 257.9999999999984, 533.960491871553, 637.999999997962, 448.99977086639774, 156.99988376572264, 16.0, 245.99999999999537, 100.99997874408436, 674.9999963978443, 159.99057393704027, 456.9999962002851, 158.99998717915938, 21.000043101207083, 292.3219594412503, 17.98790689286136, 255.71326861269557, 3.9999998016488503]
  F= 79087.0182472691   W= [533.9301563571747, 347.0, 674.9999963680583, 255.71364139403897, 375.99999999998766, 119.0, 20.999962520578315, 276.9997719564575, 637.9999999979623, 296.29315028637876, 596.9999946725609, 618.9999999999993, 257.9999999999984, 100.99997879254913, 424.0, 389.0000000000046, 245.99999999999537, 182.9998398586286, 159.98842978185345, 456.9999962189583, 17.987906535941285, 156.99979137481319, 16.0, 158.9999808145821, 448.9985895227594, 522.0888135467195]
mean time = 556.0414481163025
Skipped 129 / 286

#############
gTol experiment
xgmmvb: UpdateTol=0.05 k=18 n~3000 trial 3 tol 1.0 gTol=-1
Models:
  F= 3682.7528729508076   W= [330.6627229262142, 254.96783782724003, 159.29759615627881, 158.335822049779, 214.06192777390604, 90.99457170368282, 508.00912196912157, 438.75092456068285, 112.31614961741695, 353.6033254156777]
  F= 3682.753345889062   W= [112.29740032408351, 330.6516210585445, 254.98061302098824, 158.33571602009005, 214.66207428963608, 438.58752103232456, 507.67621098280904, 90.99462019557444, 353.604057724563, 159.2101653513866]
  F= 3682.75284467042   W= [158.33577186101365, 330.6634630420002, 254.96997817887333, 438.73805956067946, 508.01690313743916, 214.0095777999046, 159.29850653349556, 90.99456775565619, 112.31721145289762, 353.6559606780402]
mean time = 216.39513810475668

xgmmvb: UpdateTol=0.05 k=18 n~3000 trials 3 tol 1.0 gTol=0.001
Models:
  F= 3682.75322917387   W= [330.65879621101055, 254.9823894179076, 159.359538437826, 158.3356842532881, 214.87356015994834, 90.99462040342955, 507.6872153305841, 438.81706789509656, 112.3120680188006, 352.9790598721085]
  F= 3682.7534314581217   W= [112.29336934852773, 330.64817948000325, 254.99112193634852, 158.33561939064322, 215.33111789772272, 438.63708743175283, 507.41965890402975, 90.9946604919062, 353.09893439997614, 159.25025071908973]
  F= 3682.7532100338403   W= [158.33565910883996, 330.65976755488094, 254.98179256617385, 438.81010269683645, 507.71469421522926, 214.85911351109945, 159.35584552180126, 90.99461813783566, 112.31336543633043, 352.97504125097265]
mean time = 191.84370024998984
-->Faster and better!

xgmmvb: UpdateTol=0.05 k=18 n~3000 trials 3 tol 1.0 gTol=0.01
Models:
  F= 3680.940096911423   W= [330.6008611468546, 254.0189698262148, 157.21828190647875, 158.34426698204246, 530.9854585101816, 90.98953425093941, 549.4150044143672, 435.8400504945507, 113.58757246837047]
  F= 3680.940090730872   W= [530.9832042531075, 330.6008993319825, 158.34428430414135, 113.58713621594785, 254.0163631263157, 90.98953459310613, 549.4287065060304, 435.8375945922928, 157.21227707707578]
  F= 3680.940087373343   W= [158.3442856563139, 330.6009076949829, 90.98953489513377, 549.4368265269648, 254.01500278159764, 435.8334966726199, 113.58745048762839, 530.9820978926351, 157.21039739212364]
mean time = 150.59316595395407
-->Note: minimal loss of F, but these only have 9 components, not 10

gTol=0.01
python -u testgmmvb.py -k28 -n10000 -s556987 -x -t3 -d6 --tol=1. > & d6k28n3kt1G.out &
-->
Models:
  F= 79115.2220789941   W= [255.71326869486654, 158.99998717915955, 448.999770866873, 637.999999997962, 159.99057393062012, 276.9997719898816, 618.9999999999995, 375.99999999998727, 182.99982725852135, 596.9999935527414, 347.0, 522.0265518059409, 257.9999999999984, 674.9999963978411, 456.9999962002852, 424.0, 245.99999999999537, 533.9604918873932, 389.0000000000046, 17.987906894179726, 119.0, 100.99997874409974, 292.3219579308007, 16.0, 156.99988376598134, 3.999999801648798, 21.00004310121875]
  F= 79105.26094222072   W= [456.9999961882444, 618.9999999999995, 159.99059214988188, 424.0, 119.0, 182.99982725572596, 637.999999997962, 596.9999935473802, 674.9999963977054, 158.99952644702034, 375.99999999998727, 100.99997873174404, 522.0266483843287, 25.017308789294844, 389.0000000000046, 257.9999999999984, 347.0, 533.9605039313363, 245.99999999999537, 255.713269767705, 448.99977119917094, 276.99977198997306, 156.99988361409447, 292.3050247039096, 16.0, 17.987906904537464]
  F= 78718.56309326051   W= [389.0000000000046, 533.9603769144513, 448.9997689603663, 159.99081248331083, 618.9999999999995, 674.9999966911245, 375.99999999998727, 424.0, 24.2781292380485, 347.0, 637.999999997962, 245.99999999999537, 21.000043016663735, 257.99999999999835, 255.70151582854075, 276.99977198844823, 596.9999936730883, 456.99999619996333, 119.0, 101.00004662219904, 519.8295486706002, 292.24036498601544, 156.99989206684876, 341.999742662384, 16.0]
mean time = 334.74462628364563
--comments
A little degradation of the results from above, but in just 60% the time.

gTol=0.001
python -u testgmmvb.py -k28 -n10000 -s556987 -x -t3 -d6 --tol=1. > & d6k28n3kt1G3.out &
Models:
  F= 79115.22207899402   W= [255.71326869486998, 158.99998717915955, 448.999770866873, 637.999999997962, 159.99057393061986, 276.9997719898816, 618.9999999999995, 375.99999999998727, 182.99982725852135, 596.9999935527414, 347.0, 522.0265518059944, 257.9999999999984, 674.9999963978411, 456.9999962002852, 424.0, 245.99999999999537, 533.9604918873939, 389.0000000000046, 17.987906894179755, 119.0, 100.99997874409974, 292.3219579307434, 16.0, 156.99988376598134, 3.999999801648798, 21.00004310121875]
  F= 79115.22207899482   W= [276.99977198988137, 618.9999999999995, 522.0265503891652, 389.0000000000046, 424.0, 347.0, 375.99999999998727, 596.9999935527405, 119.0, 182.9998272585156, 257.9999999999984, 533.9604918715531, 637.999999997962, 448.99977086639774, 156.99988376572264, 16.0, 245.99999999999537, 100.99997874408436, 674.9999963978443, 159.9905739370403, 456.9999962002851, 158.99998717915938, 21.000043101207083, 292.3219594412502, 17.98790689286137, 255.71326861269574, 3.9999998016488503]
  F= 79087.01824726908   W= [533.9301563571681, 347.0, 674.9999963680583, 255.71364139402777, 375.99999999998766, 119.0, 20.999962520578308, 276.9997719564575, 637.9999999979623, 296.2931502866226, 596.9999946725609, 618.9999999999993, 257.9999999999984, 100.99997879254913, 424.0, 389.0000000000046, 245.99999999999537, 182.9998398586286, 159.9884297818539, 456.9999962189583, 17.987906535941104, 156.99979137481313, 16.0, 158.9999808145821, 448.9985895227593, 522.0888135464933]
mean time = 358.3571985562642

comments:
Only about 5% slower than with 0.01 gTol, but more accurate; Result is essentially same as, but still 35% faster than, without gTol>0
